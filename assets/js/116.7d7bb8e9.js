(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{541:function(s,t,a){"use strict";a.r(t);var e=a(17),i=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"蒙特卡洛方法与-mcmc-采样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#蒙特卡洛方法与-mcmc-采样"}},[s._v("#")]),s._v(" 蒙特卡洛方法与 MCMC 采样")]),s._v(" "),a("blockquote",[a("p",[s._v("故事的结局早就写在开头")])]),s._v(" "),a("h2",{attrs:{id:"蒙特卡洛模拟"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#蒙特卡洛模拟"}},[s._v("#")]),s._v(" 蒙特卡洛模拟")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msub",[a("mrow",[a("mi",{attrs:{mathvariant:"double-struck"}},[s._v("E")])],1),a("mrow",[a("mi",[s._v("x")]),a("mo",[s._v("∼")]),a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")])],1)],1),a("mo",[s._v("[")]),a("mi",[s._v("f")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")]),a("mo",[s._v("]")]),a("mo",[s._v("=")]),a("mo",[s._v("∫")]),a("mi",[s._v("f")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")]),a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")]),a("mi",[s._v("d")]),a("mi",[s._v("x")]),a("mo",[s._v("≈")]),a("mfrac",[a("mrow",[a("mn",[s._v("1")])],1),a("mrow",[a("mi",[s._v("n")])],1)],1),a("msubsup",[a("mo",[s._v("∑")]),a("mrow",[a("mi",[s._v("i")]),a("mo",[s._v("=")]),a("mn",[s._v("1")])],1),a("mrow",[a("mi",[s._v("n")])],1)],1),a("mi",[s._v("f")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msub",[a("mi",[s._v("x")]),a("mrow",[a("mi",[s._v("i")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mspace",{attrs:{width:"1em"}}),a("msub",[a("mi",[s._v("x")]),a("mrow",[a("mi",[s._v("i")])],1)],1),a("mo",[s._v("∼")]),a("mi",[s._v("p")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\mathbb { E } _ { x \\sim p ( x ) } [ f ( x ) ] = \\int f ( x ) p ( x ) d x \\approx \\frac { 1 } { n } \\sum _ { i = 1 } ^ { n } f \\left( x _ { i } \\right) , \\quad x _ { i } \\sim p ( x )\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.6513970000000002em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"2.929066em","vertical-align":"-1.277669em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{},[a("span",{staticClass:"mord displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathbb"},[s._v("E")])]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.18019999999999992em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mrel"},[s._v("∼")]),a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("[")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mclose"},[s._v("]")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"op-symbol large-op mop",staticStyle:{"margin-right":"0.44445em",top:"-0.0011249999999999316em"}},[s._v("∫")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mord mathit"},[s._v("d")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mrel"},[s._v("≈")]),a("span",{staticClass:"mord reset-textstyle displaystyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.686em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle cramped"},[a("span",{staticClass:"mord textstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("n")])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.677em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped"},[a("span",{staticClass:"mord textstyle uncramped"},[a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})]),a("span",{staticClass:"mop op-limits"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"1.1776689999999999em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("i")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticStyle:{top:"-0.000005000000000143778em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",[a("span",{staticClass:"op-symbol large-op mop"},[s._v("∑")])])]),a("span",{staticStyle:{top:"-1.2500050000000003em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("n")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("i")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mord mspace quad"}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.05em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("i")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mrel"},[s._v("∼")]),a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("h2",{attrs:{id:"采样方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#采样方法"}},[s._v("#")]),s._v(" 采样方法")]),s._v(" "),a("h3",{attrs:{id:"逆采样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#逆采样"}},[s._v("#")]),s._v(" 逆采样")]),s._v(" "),a("p",[s._v("对累积分布函数已知的分布的采样方法。")]),s._v(" "),a("p",[a("strong",[s._v("反函数存在定理")]),s._v("\n定理：严格单调函数必定有严格单调的反函数，并且二者单调性相同。")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("msup",[a("mi",[s._v("F")]),a("mrow",[a("mo",[s._v("−")]),a("mn",[s._v("1")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("a")]),a("mo",[s._v(")")]),a("mo",[s._v("<")]),a("mi",[s._v("x")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mtext",[a("mtext"),a("mi",{attrs:{mathvariant:"normal"}},[s._v("i")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("f")]),a("mi",{attrs:{mathvariant:"normal"}},[s._v("f")]),a("mtext")],1),a("mi",[s._v("a")]),a("mo",[s._v("<")]),a("mi",[s._v("F")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("F ^ { - 1 } ( a ) < x , \\text { iff } a < F ( x )\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.864108em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.1141079999999999em","vertical-align":"-0.25em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.41300000000000003em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("−")]),a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("<")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"text mord displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mspace"}),a("span",{staticClass:"mord mathrm"},[s._v("i")]),a("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.07778em"}},[s._v("f")]),a("span",{staticClass:"mord mathrm",staticStyle:{"margin-right":"0.07778em"}},[s._v("f")]),a("span",{staticClass:"mord mspace"})]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mrel"},[s._v("<")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",[s._v("因此 , 记"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("H")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("H")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.08125em"}},[s._v("H")])])])]),s._v(" 为[0,1] 均匀分布的分布函数，则有")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("P")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msup",[a("mi",[s._v("F")]),a("mrow",[a("mo",[s._v("−")]),a("mn",[s._v("1")])],1)],1),a("mo",[s._v("(")]),a("mi",[s._v("a")]),a("mo",[s._v(")")]),a("mo",[s._v("≤")]),a("mi",[s._v("x")]),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1),a("mo",[s._v("=")]),a("mi",[s._v("P")]),a("mo",[s._v("(")]),a("mi",[s._v("a")]),a("mo",[s._v("≤")]),a("mi",[s._v("F")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mi",[s._v("H")]),a("mo",[s._v("(")]),a("mi",[s._v("F")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")]),a("mo",[s._v(")")]),a("mo",[s._v("=")]),a("mi",[s._v("F")]),a("mo",[s._v("(")]),a("mi",[s._v("x")]),a("mo",[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("P \\left( F ^ { - 1 } ( a ) \\leq x \\right) = P ( a \\leq F ( x ) ) = H ( F ( x ) ) = F(x)\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"0.864108em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.214118em","vertical-align":"-0.35001em"}}),a("span",{staticClass:"base displaystyle textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("P")]),a("span",{staticClass:"minner displaystyle textstyle uncramped"},[a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[a("span",{staticClass:"delimsizing size1"},[s._v("(")])]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"-0.41300000000000003em","margin-right":"0.05em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord"},[s._v("−")]),a("span",{staticClass:"mord mathrm"},[s._v("1")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("≤")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"style-wrap reset-textstyle textstyle uncramped",staticStyle:{top:"0em"}},[a("span",{staticClass:"delimsizing size1"},[s._v(")")])])]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("P")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("a")]),a("span",{staticClass:"mrel"},[s._v("≤")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.08125em"}},[s._v("H")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.13889em"}},[s._v("F")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",[s._v("因此，逆采样的步骤为")]),s._v(" "),a("ol",[a("li",[s._v("从 Uniform(0,1) 中随机生成一个值，用 u 表示。")]),s._v(" "),a("li",[s._v("计算 F^{−1}(u) 的值 x，则 x 就是从 f(x) 中得出的一个采样点。")])]),s._v(" "),a("h3",{attrs:{id:"拒绝采样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拒绝采样"}},[s._v("#")]),s._v(" 拒绝采样")]),s._v(" "),a("p",[s._v("对于那些复杂的不可求逆的分布，拒绝采样就是针对此类复杂问题的一种随机采样方法")]),s._v(" "),a("p",[s._v("想求一个空间里均匀分布的集合面积，可以尝试在更大范围内按照均匀分布随机采样，如果采样点在集合中，则接受，否则拒绝。最后的接受概率就是集合在”更大范围“的面积占比。")]),s._v(" "),a("p",[s._v("重复如下步骤，直到获得 m 个被接受的采样点")]),s._v(" "),a("ol",[a("li",[s._v("从 q(x) 中获得一个随机采样点 x(i)")]),s._v(" "),a("li",[s._v("对于 xi 计算接受概率（acceptance probability） "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mi",[s._v("α")]),a("mo",[s._v("=")]),a("mfrac",[a("mrow",[a("mi",[s._v("p")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msub",[a("mi",[s._v("x")]),a("mrow",[a("mi",[s._v("i")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1)],1),a("mrow",[a("mi",[s._v("M")]),a("mi",[s._v("q")]),a("mrow",[a("mo",{attrs:{fence:"true"}},[s._v("(")]),a("msub",[a("mi",[s._v("x")]),a("mrow",[a("mi",[s._v("i")])],1)],1),a("mo",{attrs:{fence:"true"}},[s._v(")")])],1)],1)],1)],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\alpha = \\frac { p \\left( x _ { i } \\right) } { M q \\left( x _ { i } \\right) }")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"strut",staticStyle:{height:"1.01em"}}),a("span",{staticClass:"strut bottom",staticStyle:{height:"1.53em","vertical-align":"-0.52em"}}),a("span",{staticClass:"base textstyle uncramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.0037em"}},[s._v("α")]),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mord reset-textstyle textstyle uncramped"},[a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"}),a("span",{staticClass:"mfrac"},[a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.34500000000000003em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0.7em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle cramped"},[a("span",{staticClass:"mord scriptstyle cramped"},[a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.10903em"}},[s._v("M")]),a("span",{staticClass:"mord mathit",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")]),a("span",{staticClass:"minner scriptstyle cramped"},[a("span",{staticClass:"style-wrap reset-scriptstyle scriptstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("i")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-scriptstyle scriptstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])])])])]),a("span",{staticStyle:{top:"-0.22999999999999998em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0.7em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle textstyle uncramped frac-line"})]),a("span",{staticStyle:{top:"-0.485em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0.7em"}},[s._v("​")])]),a("span",{staticClass:"reset-textstyle scriptstyle uncramped"},[a("span",{staticClass:"mord scriptstyle uncramped"},[a("span",{staticClass:"mord mathit"},[s._v("p")]),a("span",{staticClass:"minner scriptstyle uncramped"},[a("span",{staticClass:"style-wrap reset-scriptstyle scriptstyle uncramped",staticStyle:{top:"0em"}},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathit"},[s._v("x")]),a("span",{staticClass:"vlist"},[a("span",{staticStyle:{top:"0.15em","margin-right":"0.07142857142857144em","margin-left":"0em"}},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),a("span",{staticClass:"reset-scriptstyle scriptscriptstyle cramped"},[a("span",{staticClass:"mord scriptscriptstyle cramped"},[a("span",{staticClass:"mord mathit"},[s._v("i")])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"style-wrap reset-scriptstyle scriptstyle uncramped",staticStyle:{top:"0em"}},[s._v(")")])])])])]),a("span",{staticClass:"baseline-fix"},[a("span",{staticClass:"fontsize-ensurer reset-size5 size5"},[a("span",{staticStyle:{"font-size":"0.7em"}},[s._v("​")])]),s._v("​")])])]),a("span",{staticClass:"sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"})])])])])]),s._v(" "),a("li",[s._v("从 Uniform(0,1) 中随机生成一个值，用 u 表示")]),s._v(" "),a("li",[s._v("如果 α≥u，则接受 xi 作为一个来自 p(x) 的采样值，否则就拒绝 xi 并回到第一步")])]),s._v(" "),a("h3",{attrs:{id:"自适应的拒绝采样（adaptive-rejection-sampling）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自适应的拒绝采样（adaptive-rejection-sampling）"}},[s._v("#")]),s._v(" 自适应的拒绝采样（Adaptive Rejection Sampling）")]),s._v(" "),a("p",[s._v("拒绝采样的弱点在于当被拒绝的点很多时，采样的效率会非常不理想。同时我们也支持，如果能够找到一个跟目标分布函数非常接近的参考函数，那么就可以保证被接受的点占大多数（被拒绝的点很少）。这样一来便克服了拒绝采样效率不高的弱点。如果函数是 log-concave 的话，那么我们就可以采样自适应的拒绝采样方法")]),s._v(" "),a("h3",{attrs:{id:"重要性采样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重要性采样"}},[s._v("#")]),s._v(" 重要性采样")])])}),[],!1,null,null,null);t.default=i.exports}}]);