# 蒙特卡洛方法与 MCMC 采样

> 故事的结局早就写在开头

## 蒙特卡洛模拟

$$
\mathbb { E } _ { x \sim p ( x ) } [ f ( x ) ] = \int f ( x ) p ( x ) d x \approx \frac { 1 } { n } \sum _ { i = 1 } ^ { n } f \left( x _ { i } \right) , \quad x _ { i } \sim p ( x )
$$

## 采样方法

### 逆采样

对累积分布函数已知的分布的采样方法。

**反函数存在定理**
定理：严格单调函数必定有严格单调的反函数，并且二者单调性相同。

$$
F ^ { - 1 } ( a ) < x , \text { iff } a < F ( x )
$$

因此 , 记$H$ 为[0,1] 均匀分布的分布函数，则有

$$
P \left( F ^ { - 1 } ( a ) \leq x \right) = P ( a \leq F ( x ) ) = H ( F ( x ) ) = F(x)
$$

因此，逆采样的步骤为

1. 从 Uniform(0,1) 中随机生成一个值，用 u 表示。
2. 计算 $F^{−1}(u)$ 的值 x，则 x 就是从 f(x) 中得出的一个采样点。

### 拒绝采样

对于那些复杂的不可求逆的分布，拒绝采样就是针对此类复杂问题的一种随机采样方法

想求一个空间里均匀分布的集合面积，可以尝试在更大范围内按照均匀分布随机采样，如果采样点在集合中，则接受，否则拒绝。最后的接受概率就是集合在”更大范围“的面积占比。

重复如下步骤，直到获得 m 个被接受的采样点

1. 从 q(x) 中获得一个随机采样点 x(i)
2. 对于 xi 计算接受概率（acceptance probability） $\alpha = \frac { p \left( x _ { i } \right) } { M q \left( x _ { i } \right) }$
3. 从 Uniform(0,1) 中随机生成一个值，用 u 表示
4. 如果 α≥u，则接受 xi 作为一个来自 p(x) 的采样值，否则就拒绝 xi 并回到第一步

### 自适应的拒绝采样（Adaptive Rejection Sampling）


拒绝采样的弱点在于当被拒绝的点很多时，采样的效率会非常不理想。同时我们也支持，如果能够找到一个跟目标分布函数非常接近的参考函数，那么就可以保证被接受的点占大多数（被拒绝的点很少）。这样一来便克服了拒绝采样效率不高的弱点。如果函数是 log-concave 的话，那么我们就可以采样自适应的拒绝采样方法



### 重要性采样
