# C++ 知识点 {ignore=ture}

[TOC]

> 如果将编程语言比作武功秘籍，C++无异于《九阴真经》。《九阴真经》威力强大、博大精深，经中所载内功、轻功、拳、掌、腿、刀法、剑法、杖法、鞭法、指爪、点穴密技、疗伤法门、闭气神功、移魂大法等等，无所不包，C++亦如是。

## C++ 语法关键

### 函数声明和对象定义

对象定义写成空的初始化列表时，会被解析成一个函数声明。

```c++

//这是一个函数声明
//不是一个对象定义
string foo();


//函数声明
string foo(void);


//对象定义几种方法
string foo;
string foo{ };//c++11
string *foo = new string;
string *foo = new string();
string *foo = new string{ };//c++11
```

### 类型

- 枚举类型
  占用 4 个字节

- 柔性数组
  - 例如
    ```cpp
    struct A{
    Int a;
    char data[0]; // 必须是结构体的最后一个元素
    };
    ```
    柔性数组其实只是一个标识占位符，并不占结构体的空间

### 指针

指针

- 指针数组： 每个元素都是指针 `char \*p[10];`
- 数组指针： 指向数组的指针 `int (\*p)[10]`; 对二维数组，可以用数组指针指向一行，然后 p++ 就指向下一行（注意数组指针的步长为列数），数组指针因此也被称为行指针
- 声明一个类的指针数组时，并不会调用该类的构造函数

#### 智能指针

std::auto_ptr

#### 共享指针

std::shared_ptr

### 友元

友元函数本身不是类的成员函数

### 多态

函数重载和模板属于编译时多态

如果不是虚函数，则用子类初始化的基类指针调用的是基类的，对析构函数也是如此，因此，为了使子类正常析构，子类的析构函数通常被声明为虚函数。

### 联合体

联合体的占用空间取其包含元素的最大占用空间

### 编译

`g++ -o test test.cpp`

### static 关键字

static 关键字的作用：隐藏，持久化，初始化为 0

- 静态全局变量
  - 作用域仅限于当前源文件，且只初始化一次
- 静态局部变量
- 静态函数
  - 普通函数在每次被调用时均有一份拷贝，而静态函数在内存中只拷贝一份，因此比较节约内存
  - 静态函数只在声明它的源文件中可见，因此其他文件中可以定义相同名字的函数，不会发生冲突

### 输入输出流

- stdio.h 与 cstdio 的区别：前者是 C 的标准库，后者是 C++中对前者的封装；其他如 stdlib.h 与 cstdlib 同理。

### inline 内联函数

内联类似于宏定义，在调用处直接展开被调函数，以此来代替函数调用，在消除宏定义的缺点的同时又保留了其优点。内联有以下几个主要特点

1. 内联可以发生在任何时机，包括编译期、链接期、运行时等；
2. 有些编译器即使不加 `inline` 关键字，也可能会对短小的函数做内联优化
3. 编译器很无情，即使你加了 inline，它也可能拒绝你的 inline
4. 不合理的 inline 会导致代码臃肿

### 模板元编程

### 魔鬼在细节之中

一些容易混淆和忽略的点

- 赋值表达式的返回值即所赋值本身

静态对象初始化顺序
在同一个编译单元中，静态对象的初始化次序与其定义顺序保持一致。对于作用域为多个编译单元的静态对象，不能保证其初始化次序。

如果我们需要指定依赖关系，比如 y 依赖 x 进行初始化，可以利用这样一个特性来实现：函数内部的静态对象在函数第一次调用时初始化，且只被初始化一次。使用该方法，访问静态对象的唯一途径就是调用该函数

## STL

- STL string
  - 构造 string a("this is a string");
  - size(), empty()
- string stream
  - istringstream
  - ostringstream
  - string 化： .str()

* 对齐
  - `#pragma pack(4)`

## 并行编程

[gitbook: C++ 并发编程](https://www.gitbook.com/book/chenxiaowei/cpp_concurrency_in_action/details)

## 常用库


### algorithm

### cstring 和 string





- [argparse-参数解析](https://github.com/p-ranav/argparse)
- [getopt:命令行参数解析]()



## 参考资料

[Awesome Cpp](https://github.com/fffaraz/awesome-cpp)
